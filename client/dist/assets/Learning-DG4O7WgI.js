var e=Object.defineProperty,t=(t,i,n)=>((t,i,n)=>i in t?e(t,i,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[i]=n)(t,"symbol"!=typeof i?i+"":i,n);import{G as i,H as n,I as s,j as r,J as a,K as o,L as l,e as d,p as c,M as u}from"./index-CZtzjuKv.js";import{b as h,i as p,R as m,c as g}from"./vendor-CCW8Is9m.js";import{R as v,Q as f}from"./quill.snow-C8zidYNu.js";const b=e=>{const t=e.match(/(?:youtu\.be\/|youtube\.com\/(?:watch\?v=|embed\/))([\w-]{11})/);return t?`https://www.youtube.com/embed/${t[1]}`:null},x=e=>`${Math.floor(e/60)}:${Math.floor(e%60).toString().padStart(2,"0")}`,y=({lecture:e})=>{const{user:t}=n((e=>e.auth)),a=h.useRef(null),o=h.useRef(null),[l,d]=h.useState(0),[c,u]=h.useState(0),[p,m]=h.useState(0),[g,v]=h.useState(!1),[f,y]=h.useState(null),[j,w]=h.useState(!1),{data:N,isLoading:z}=s(null==e?void 0:e.id,{skip:!(null==e?void 0:e.id)}),{startTrackingProgress:T,updateVideoProgress:k,isTracking:S,error:E}=((e,t,n)=>{const[s]=i(),[r,a]=h.useState(!1),[o,l]=h.useState(0),[d,c]=h.useState(null),u=h.useRef(0),p=h.useRef(null),m=!0===(null==n?void 0:n.is_completed),g=h.useCallback((async(i,n,r=!1)=>{if(!m)try{const a=Math.floor(i),o=Math.floor(n);if(!e||!t)return void c("Missing lecture ID or duration");const d=Date.now();if(d-u.current<5e3&&!r)return;const h=a/o*100>=95;await s({lecture_id:e,watch_duration:a,total_duration:o,is_completed:h}),u.current=d,l(a)}catch(a){c(a.message)}}),[e,t,s,m]),v=h.useCallback((i=>{if(m)return;if(!e||!t)return void c("Missing lecture ID or duration");if(a(!0),c(null),"object"==typeof i&&i.isYoutube)return()=>{p.current&&clearInterval(p.current)};if(!(i&&i instanceof HTMLVideoElement))return void c("Invalid video element");const n=()=>{i.paused||g(i.currentTime,i.duration)},s=()=>{g(i.currentTime,i.duration)},r=()=>{g(i.currentTime,i.duration)},o=()=>{g(i.duration,i.duration)};return i.addEventListener("timeupdate",n),i.addEventListener("pause",s),i.addEventListener("seeked",r),i.addEventListener("ended",o),p.current=setInterval((()=>{i.paused||g(i.currentTime,i.duration)}),5e3),()=>{i.removeEventListener("timeupdate",n),i.removeEventListener("pause",s),i.removeEventListener("seeked",r),i.removeEventListener("ended",o),p.current&&clearInterval(p.current),a(!1)}}),[e,t,g,m]);return h.useEffect((()=>()=>{p.current&&clearInterval(p.current)}),[]),{startTrackingProgress:v,updateVideoProgress:g,isTracking:r,lastSavedProgress:o,error:d}})(null==e?void 0:e.id,null==e?void 0:e.duration,N),C=!0===(null==N?void 0:N.is_completed);h.useEffect((()=>{d(0),u(0),m(0),v(!1),y(null),w(!1),o.current&&(o.current.destroy(),o.current=null)}),[null==e?void 0:e.id]),h.useEffect((()=>{E&&y(E)}),[E]),h.useEffect((()=>{var t;if(null==(t=null==e?void 0:e.video_url)?void 0:t.includes("youtu")){w(!0);let t=null;const i=()=>{const i=b(e.video_url);i&&(o.current&&(o.current.destroy(),o.current=null),o.current=new window.YT.Player("youtube-player",{height:"100%",width:"100%",videoId:i.split("/").pop(),playerVars:{playsinline:1,controls:1,rel:0},events:{onReady:e=>{const t=e.target.getDuration();u(t),(null==N?void 0:N.watch_duration)&&(e.target.seekTo(N.watch_duration),d(N.watch_duration),m(N.watch_duration/t*100))},onStateChange:e=>{if(e.data===window.YT.PlayerState.PLAYING)v(!1),t&&clearInterval(t),C||(t=setInterval((()=>{if(o.current){const e=o.current.getCurrentTime(),t=o.current.getDuration();d(e),m(e/t*100),k(e,t,!0)}}),5e3));else if(e.data===window.YT.PlayerState.PAUSED){if(t&&clearInterval(t),o.current&&!C){const e=o.current.getCurrentTime(),t=o.current.getDuration();k(e,t,!0)}}else if(e.data===window.YT.PlayerState.ENDED){if(t&&clearInterval(t),o.current&&!C){const e=o.current.getDuration();k(e,e,!0)}}else e.data===window.YT.PlayerState.BUFFERING&&v(!0)},onError:e=>{y("Error playing YouTube video")}}}))};if(window.YT&&window.YT.Player)i();else{const e=document.createElement("script");e.src="https://www.youtube.com/iframe_api";const t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t),window.onYouTubeIframeAPIReady=i}return()=>{t&&clearInterval(t),o.current&&(o.current.destroy(),o.current=null)}}}),[null==e?void 0:e.video_url,N,k,C]),h.useEffect((()=>{if(a.current&&(null==e?void 0:e.id)&&(null==e?void 0:e.video_url)&&!e.video_url.includes("youtu")&&(null==e?void 0:e.duration)){console.log("[VideoPlayer] Start tracking progress for",null==e?void 0:e.id,null==e?void 0:e.title);return T(a.current)}}),[T,null==e?void 0:e.id,null==e?void 0:e.video_url,null==e?void 0:e.duration]),h.useEffect((()=>{N&&!j&&a.current&&(a.current.currentTime=N.watch_duration,d(N.watch_duration),m(N.watch_duration/N.total_duration*100))}),[N,j]);const L=()=>{if(a.current){const e=a.current.currentTime,t=e/a.current.duration*100;d(e),m(t)}},_=()=>{if(a.current){const e=a.current.duration;u(e)}},P=()=>{v(!0)},R=()=>{v(!1)};return e?e.video_url?e.video_url.includes("youtu")?(b(e.video_url),r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"video-container position-relative bg-dark",style:{minHeight:500,height:500},children:r.jsx("div",{id:"youtube-player",style:{width:"100%",height:"100%"}})}),r.jsxs("div",{className:"bg-dark bg-opacity-75 p-2 mt-0",children:[r.jsxs("div",{className:"d-flex justify-content-between align-items-center text-white mb-1",children:[r.jsxs("small",{children:[x(l)," / ",x(c)]}),r.jsx("small",{children:C?r.jsx("span",{className:"text-success",children:"Completed!"}):g?r.jsx("span",{className:"text-warning",children:"Buffering..."}):`${Math.round(p)}% watched`})]}),r.jsx("div",{className:"progress",style:{height:"4px"},children:r.jsx("div",{className:"progress-bar "+(C?"bg-success":"bg-primary"),role:"progressbar",style:{width:`${p}%`},"aria-valuenow":p,"aria-valuemin":"0","aria-valuemax":"100"})}),S&&!C&&r.jsx("small",{className:"text-success d-block mt-1",children:"Progress is being saved..."}),f&&r.jsxs("small",{className:"text-danger d-block mt-1",children:["Error: ",f]})]})]})):e.video_url?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"video-container position-relative bg-dark",style:{minHeight:400,height:400},children:r.jsxs("video",{ref:a,className:"w-100 h-100",controls:!0,playsInline:!0,controlsList:"nodownload",style:{objectFit:"contain",height:400},onTimeUpdate:L,onLoadedMetadata:_,onWaiting:P,onPlaying:R,children:[r.jsx("source",{src:e.video_url,type:"video/mp4"}),"Your browser does not support the video tag."]},e.id)}),r.jsxs("div",{className:"bg-dark bg-opacity-75 p-2 mt-0",children:[r.jsxs("div",{className:"d-flex justify-content-between align-items-center text-white mb-1",children:[r.jsxs("small",{children:[x(l)," / ",x(c)]}),r.jsx("small",{children:C?r.jsx("span",{className:"text-success",children:"Completed!"}):g?r.jsx("span",{className:"text-warning",children:"Buffering..."}):`${Math.round(p)}% watched`})]}),r.jsx("div",{className:"progress",style:{height:"4px"},children:r.jsx("div",{className:"progress-bar "+(C?"bg-success":"bg-primary"),role:"progressbar",style:{width:`${p}%`},"aria-valuenow":p,"aria-valuemin":"0","aria-valuemax":"100"})}),S&&!C&&r.jsx("small",{className:"text-success d-block mt-1",children:"Progress is being saved..."}),f&&r.jsxs("small",{className:"text-danger d-block mt-1",children:["Error: ",f]})]})]}):r.jsx("div",{className:"video-container position-relative bg-dark",style:{minHeight:400},children:r.jsx("div",{className:"d-flex justify-content-center align-items-center h-100",children:r.jsx("span",{className:"text-white",children:"No video available"})})}):r.jsx("div",{className:"video-container position-relative bg-dark",style:{minHeight:400},children:r.jsx("div",{className:"d-flex justify-content-center align-items-center h-100",children:r.jsx("span",{className:"text-white",children:"No video available for this lecture"})})}):r.jsx("div",{className:"video-container position-relative bg-dark",style:{minHeight:500},children:r.jsx("div",{className:"d-flex justify-content-center align-items-center h-100",children:r.jsx("span",{className:"text-white",children:"No lecture selected"})})})},j=({TABS:e,activeTab:t,setActiveTab:i,renderTabContent:n})=>r.jsxs(r.Fragment,{children:[r.jsx("ul",{className:"nav nav-tabs px-4 border-bottom",style:{background:"#fff"},children:e.map((e=>r.jsx("li",{className:"nav-item",children:r.jsx("button",{className:"nav-link "+(t===e.key?"active":""),onClick:()=>i(e.key),style:{cursor:"pointer"},children:e.label})},e.key)))}),r.jsx("div",{style:{background:"#fff",minHeight:300,borderBottomLeftRadius:8},children:n()})]}),w=({sections:e,expandedSection:t,setExpandedSection:i,selectedLecture:n,setSelectedLecture:s,formatDuration:a,lectureProgressMap:o={}})=>r.jsxs("div",{className:"p-0 h-100 bg-white border-start",style:{minHeight:"100vh"},children:[r.jsx("div",{className:"p-4 border-bottom",children:r.jsx("span",{className:"fw-bold fs-6",children:"Course content"})}),r.jsx("div",{className:"overflow-auto",style:{maxHeight:"calc(100vh - 60px)"},children:e.map(((e,l)=>{const d=e.lectures.reduce(((e,t)=>e+(t.duration||0)),0),c=e.lectures.filter((e=>{var t;return!0===(null==(t=o[e.id])?void 0:t.is_completed)})).length;return r.jsxs("div",{className:"border-bottom",children:[r.jsxs("div",{className:"d-flex align-items-center justify-content-between px-4 py-3 bg-white section-title",style:{cursor:"pointer"},onClick:()=>i(t===e.id?null:e.id),children:[r.jsxs("div",{className:"d-flex flex-column",children:[r.jsx("div",{className:"fw-bold",children:`Section ${l+1}: ${e.title}`}),r.jsx("span",{className:"small text-muted",children:`${c} / ${e.lectures.length} | ${a(d)}`})]}),r.jsx("div",{className:"d-flex align-items-center gap-3",children:r.jsx("i",{className:`bi ${t===e.id?"bi-chevron-up":"bi-chevron-down"} text-muted`})})]}),r.jsx("ul",{className:"list-group list-group-flush "+(t===e.id?"show":"collapse"),children:e.lectures.map(((e,t)=>{const i=o[e.id],l=!0===(null==i?void 0:i.is_completed);return r.jsxs("li",{className:"list-group-item d-flex align-items-center justify-content-between px-4 py-2 border-0 "+((null==n?void 0:n.id)===e.id?"bg-primary bg-opacity-10 text-primary":"bg-transparent"),style:{cursor:"pointer",borderRadius:0},onClick:()=>s(e),children:[r.jsxs("div",{className:"d-flex align-items-center gap-2 flex-grow-1",children:[r.jsx("input",{type:"checkbox",className:"form-check-input me-2",style:{pointerEvents:"none"},checked:l,readOnly:!0}),r.jsxs("span",{className:"small text-muted",children:[t+1,"."]}),r.jsx("span",{className:"small fw-semibold ms-1",children:e.title})]}),r.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.resources&&e.resources.length>0&&r.jsxs("div",{className:"dropdown",children:[r.jsx("button",{className:"btn btn-sm btn-outline-secondary dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false",children:"Resources"}),r.jsx("ul",{className:"dropdown-menu",children:e.resources.map(((e,t)=>r.jsx("li",{children:r.jsx("a",{className:"dropdown-item",href:e.url,target:"_blank",rel:"noopener noreferrer",children:e.name})},t)))})]}),r.jsx("span",{className:"small text-muted ms-2",children:a(e.duration)})]})]},e.id)}))})]},e.id)}))})]}),N=e=>{if("number"!=typeof e||isNaN(e)||e<0)return"00:00";const t=Math.floor(e/3600),i=Math.floor(e%3600/60),n=e%60;return t>0?`${t}:${i.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`:`${i.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`},z=e=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(e),T=({data:e,formatDuration:t,formatPrice:i})=>r.jsxs("div",{className:"p-4",children:[r.jsx("h5",{className:"fw-bold mb-3",children:e.title}),r.jsxs("div",{className:"mb-2",children:[r.jsx("span",{className:"badge bg-secondary me-2",children:e.category}),r.jsx("span",{className:"badge bg-info",children:e.level})]}),r.jsxs("div",{className:"mb-2 text-muted",children:[r.jsx("i",{className:"bi bi-person-circle me-2"}),e.instructor]}),r.jsxs("div",{className:"mb-2 text-muted",children:[r.jsx("i",{className:"bi bi-clock me-2"}),t(e.duration)]}),r.jsxs("div",{className:"mb-2 text-muted",children:[r.jsx("i",{className:"bi bi-currency-dollar me-2"}),i(e.price)]}),r.jsx("div",{className:"mt-3 text-muted",dangerouslySetInnerHTML:{__html:e.description}})]}),k=({lectures:e,selectedLecture:t,onLectureChange:i})=>r.jsxs("div",{className:"d-flex flex-wrap gap-2 mb-3",children:[r.jsxs("select",{className:"form-select w-auto",value:t,onChange:e=>i(e.target.value),children:[r.jsx("option",{value:"",children:"All lectures"}),e.map((e=>r.jsx("option",{value:e.id,children:e.title},e.id)))]}),r.jsx("select",{className:"form-select w-auto",children:r.jsx("option",{children:"Sort by recommended"})}),r.jsx("button",{className:"btn btn-outline-primary",children:"Filter questions"})]}),S=({question:e,onEdit:t,onDelete:i,currentUserId:n})=>r.jsxs("div",{className:"card p-3",children:[r.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[r.jsx("div",{className:"d-flex align-items-center gap-2",children:r.jsx("div",{className:"fw-bold",children:e.title})}),n===e.user_id&&r.jsxs("div",{className:"d-flex gap-2",children:[r.jsx("button",{className:"btn btn-sm btn-outline-warning",onClick:()=>t(e),children:r.jsx("i",{className:"bi bi-pencil-square"})}),r.jsx("button",{className:"btn btn-sm btn-outline-danger",onClick:()=>i(e.id),children:r.jsx("i",{className:"bi bi-trash"})})]})]}),r.jsx("div",{className:"question-content",style:{paddingLeft:2},children:r.jsx("div",{dangerouslySetInnerHTML:{__html:e.question}})}),r.jsxs("div",{className:"d-flex gap-2 justify-content-between",children:[r.jsx("div",{className:"fw-bold text-primary",children:e.user_name}),r.jsx("span",{className:"text-muted small",children:new Date(e.created_at).toLocaleDateString()})]})]}),E=({questions:e,isLoading:t,currentUserId:i,onEdit:n,onDelete:s,page:a,onPageChange:o})=>t?r.jsx("div",{children:"Loading questions..."}):(null==e?void 0:e.length)?r.jsxs("div",{className:"my-4 d-flex flex-column gap-3",children:[r.jsxs("div",{className:"fw-bold",children:["All questions in this course (",e.length,")"]}),r.jsx("div",{className:"d-flex flex-column gap-3",children:e.map((e=>r.jsx(S,{question:e,currentUserId:i,onEdit:n,onDelete:s},e.id)))}),r.jsx("nav",{className:"d-flex justify-content-center",children:r.jsxs("ul",{className:"pagination pagination-sm",children:[r.jsx("li",{className:"page-item "+(1===a?"disabled":""),children:r.jsx("button",{className:"page-link",onClick:()=>o((e=>Math.max(1,e-1))),children:r.jsx("i",{className:"bi bi-chevron-left"})})}),r.jsx("li",{className:"page-item",children:r.jsx("span",{className:"page-link",children:a})}),r.jsx("li",{className:"page-item",children:r.jsx("button",{className:"page-link",onClick:()=>o((e=>e+1)),children:r.jsx("i",{className:"bi bi-chevron-right"})})})]})})]}):r.jsx("div",{className:"text-muted",children:"No questions yet."});var C,L,_,P,R,I={exports:{}};function q(){if(L)return C;L=1;return C="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"}function H(){if(P)return _;P=1;var e=q();function t(){}function i(){}return i.resetWarningCache=t,_=function(){function n(t,i,n,s,r,a){if(a!==e){var o=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function s(){return n}n.isRequired=n;var r={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:s,element:n,elementType:n,instanceOf:s,node:n,objectOf:s,oneOf:s,oneOfType:s,shape:s,exact:s,checkPropTypes:i,resetWarningCache:t};return r.PropTypes=r,r}}function D(){return R||(R=1,I.exports=H()()),I.exports}const M=p(D());var A,O={exports:{}};const $=p((A||(A=1,O.exports=function(){function e(e){if("undefined"!=typeof window){var t=document.createElement("style");return t.setAttribute("media","screen"),t.innerHTML=e,document.head.appendChild(t),e}}
/*! *****************************************************************************
      		    Copyright (c) Microsoft Corporation.
      
      		    Permission to use, copy, modify, and/or distribute this software for any
      		    purpose with or without fee is hereby granted.
      
      		    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
      		    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
      		    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
      		    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
      		    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
      		    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
      		    PERFORMANCE OF THIS SOFTWARE.
      		    ***************************************************************************** */var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,i)};function i(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}var n=function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var s in t=arguments[i])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},n.apply(this,arguments)};e('#editor-resizer {\n  position: absolute;\n  border: 1px dashed #fff;\n  background-color: rgba(0, 0, 0, 0.5);\n}\n#editor-resizer .handler {\n  position: absolute;\n  right: -5px;\n  bottom: -5px;\n  width: 10px;\n  height: 10px;\n  border: 1px solid #333;\n  background-color: rgba(255, 255, 255, 0.8);\n  cursor: nwse-resize;\n  user-select: none;\n}\n#editor-resizer .toolbar {\n  position: absolute;\n  top: -5em;\n  left: 50%;\n  padding: 0.5em;\n  border: 1px solid #fff;\n  border-radius: 3px;\n  background-color: #fff;\n  box-shadow: 0 0 3px rgba(0, 0, 0, 0.5);\n  transform: translateX(-50%);\n  width: 20em;\n}\n#editor-resizer .toolbar .group {\n  display: flex;\n  border: 1px solid #aaa;\n  border-radius: 6px;\n  white-space: nowrap;\n  text-align: center;\n  line-height: 2;\n  color: rgba(0, 0, 0, 0.65);\n}\n#editor-resizer .toolbar .group:not(:first-child) {\n  margin-top: 0.5em;\n}\n#editor-resizer .toolbar .group .btn {\n  flex: 1 0 0;\n  text-align: center;\n  width: 25%;\n  padding: 0 0.5rem;\n  display: inline-block;\n  vertical-align: top;\n  user-select: none;\n  color: inherit;\n}\n#editor-resizer .toolbar .group .btn:not(:last-child) {\n  border-right: 1px solid #bbb;\n}\n#editor-resizer .toolbar .group .btn:not(.btn-group):active {\n  background-color: rgba(0, 0, 0, 0.1);\n}\n#editor-resizer .toolbar .group .input-wrapper {\n  width: 25%;\n  border: 1px solid #eee;\n  position: relative;\n  border-right: 1px solid #bbb;\n  min-width: 4em;\n}\n#editor-resizer .toolbar .group .input-wrapper::after {\n  content: " ";\n  position: absolute;\n  height: 1px;\n  background-color: #333;\n  left: 0.5em;\n  right: 1em;\n  bottom: 0.2em;\n}\n#editor-resizer .toolbar .group .input-wrapper input {\n  color: inherit;\n  text-align: center;\n  width: 100%;\n  border: none;\n  outline: none;\n  padding: 0 0.5em;\n  padding-right: 1.5em;\n}\n#editor-resizer .toolbar .group .input-wrapper input:focus ~ .tooltip {\n  display: block;\n}\n#editor-resizer .toolbar .group .input-wrapper .suffix {\n  position: absolute;\n  right: 0.5em;\n}\n#editor-resizer .toolbar .group .input-wrapper .tooltip {\n  display: none;\n  position: absolute;\n  top: 100%;\n  left: 0;\n  font-size: small;\n  background-color: #fff;\n  box-shadow: 0 0 3px #a7a7a7;\n  padding: 0 0.6em;\n  border-radius: 5px;\n  zoom: 0.85;\n}\n');var s=function(){function e(e){this.config=n(n({},r),e)}return e.prototype.findLabel=function(e){return this.config?Reflect.get(this.config,e):null},e}(),r={floatLeft:"left",floatRight:"right",center:"center",restore:"restore",altTip:"Press and hold alt to lock ratio!",inputTip:"Press enter key to apply change!"};function a(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return e.replace(/\{(\d+)\}/g,(function(e,i){return t.length>i?t[i]:""}))}!function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.originSize=null,t}i(t,e)}(HTMLElement);var o='\n<div class="handler" title="{0}"></div>\n<div class="toolbar">\n  <div class="group">\n    <a class="btn" data-type="width" data-styles="width:100%">100%</a>\n    <a class="btn" data-type="width" data-styles="width:50%">50%</a>\n    <span class="input-wrapper"><input data-type="width" maxlength="3" /><span class="suffix">%</span><span class="tooltip">{5}</span></span>\n    <a class="btn" data-type="width" data-styles="width:auto">{4}</a>\n  </div>\n  <div class="group">\n    <a class="btn" data-type="align" data-styles="float:left">{1}</a>\n    <a class="btn" data-type="align" data-styles="display:block;margin:auto;">{2}</a>\n    <a class="btn" data-type="align" data-styles="float:right;">{3}</a>\n    <a class="btn" data-type="align" data-styles="">{4}</a>\n  </div>\n</div>\n',l=function(){function e(e,t,i,n){this.resizer=null,this.startResizePosition=null,this.i18n=new s((null==n?void 0:n.locale)||r),this.options=n,this.resizeTarget=e,e.originSize||(e.originSize={width:e.clientWidth,height:e.clientHeight}),this.editor=i,this.container=t,this.initResizer(),this.positionResizerToTarget(e),this.resizing=this.resizing.bind(this),this.endResize=this.endResize.bind(this),this.startResize=this.startResize.bind(this),this.toolbarClick=this.toolbarClick.bind(this),this.toolbarInputChange=this.toolbarInputChange.bind(this),this.onScroll=this.onScroll.bind(this),this.bindEvents()}return e.prototype.initResizer=function(){var e=this.container.querySelector("#editor-resizer");e||((e=document.createElement("div")).setAttribute("id","editor-resizer"),e.innerHTML=a(o,this.i18n.findLabel("altTip"),this.i18n.findLabel("floatLeft"),this.i18n.findLabel("center"),this.i18n.findLabel("floatRight"),this.i18n.findLabel("restore"),this.i18n.findLabel("inputTip")),this.container.appendChild(e)),this.resizer=e},e.prototype.positionResizerToTarget=function(e){null!==this.resizer&&(this.resizer.style.setProperty("left",e.offsetLeft+"px"),this.resizer.style.setProperty("top",e.offsetTop-this.editor.scrollTop+"px"),this.resizer.style.setProperty("width",e.clientWidth+"px"),this.resizer.style.setProperty("height",e.clientHeight+"px"))},e.prototype.bindEvents=function(){null!==this.resizer&&(this.resizer.addEventListener("mousedown",this.startResize),this.resizer.addEventListener("click",this.toolbarClick),this.resizer.addEventListener("change",this.toolbarInputChange)),window.addEventListener("mouseup",this.endResize),window.addEventListener("mousemove",this.resizing),this.editor.addEventListener("scroll",this.onScroll)},e.prototype.onScroll=function(){this.positionResizerToTarget(this.resizeTarget)},e.prototype._setStylesForToolbar=function(e,t){var i,n="_styles_"+e,s=this.resizeTarget.style,r=this.resizeTarget[n];s.cssText=s.cssText.replaceAll(" ","").replace(r,"")+";"+t,this.resizeTarget[n]=t,this.positionResizerToTarget(this.resizeTarget),null===(i=this.options)||void 0===i||i.onChange(this.resizeTarget)},e.prototype.toolbarInputChange=function(e){var t,i=e.target,n=null===(t=null==i?void 0:i.dataset)||void 0===t?void 0:t.type,s=i.value;n&&Number(s)&&this._setStylesForToolbar(n,"width: "+Number(s)+"%;")},e.prototype.toolbarClick=function(e){var t,i,n=e.target,s=null===(t=null==n?void 0:n.dataset)||void 0===t?void 0:t.type;s&&n.classList.contains("btn")&&this._setStylesForToolbar(s,null===(i=null==n?void 0:n.dataset)||void 0===i?void 0:i.styles)},e.prototype.startResize=function(e){e.target.classList.contains("handler")&&1===e.which&&(this.startResizePosition={left:e.clientX,top:e.clientY,width:this.resizeTarget.clientWidth,height:this.resizeTarget.clientHeight})},e.prototype.endResize=function(){var e;this.startResizePosition=null,null===(e=this.options)||void 0===e||e.onChange(this.resizeTarget)},e.prototype.resizing=function(e){var t,i,n,s,r,a,o,l,d,c,u;if(this.startResizePosition){var h=e.clientX-this.startResizePosition.left,p=e.clientY-this.startResizePosition.top,m=this.startResizePosition.width,g=this.startResizePosition.height;if(m+=h,g+=p,e.altKey){var v=this.resizeTarget.originSize;g=v.height/v.width*m}var f=null!==(n=null===(i=null===(t=this.options)||void 0===t?void 0:t.resizeConstraints)||void 0===i?void 0:i.minWidth)&&void 0!==n?n:30,b=null!==(a=null===(r=null===(s=this.options)||void 0===s?void 0:s.resizeConstraints)||void 0===r?void 0:r.minHeight)&&void 0!==a?a:30;m<f&&(m=f),void 0!==(null===(l=null===(o=this.options)||void 0===o?void 0:o.resizeConstraints)||void 0===l?void 0:l.maxWidth)&&m>this.options.resizeConstraints.maxWidth&&(m=this.options.resizeConstraints.maxWidth),g<b&&(g=b),void 0!==(null===(c=null===(d=this.options)||void 0===d?void 0:d.resizeConstraints)||void 0===c?void 0:c.maxHeight)&&g>this.options.resizeConstraints.maxHeight&&(g=this.options.resizeConstraints.maxHeight),this.resizeTarget.style.setProperty("width",m+"px"),(null===(u=this.options)||void 0===u?void 0:u.keepAspectRatio)||this.resizeTarget.style.setProperty("height",g+"px"),this.positionResizerToTarget(this.resizeTarget)}},e.prototype.destory=function(){this.container.removeChild(this.resizer),window.removeEventListener("mouseup",this.endResize),window.removeEventListener("mousemove",this.resizing),this.editor.removeEventListener("scroll",this.onScroll),this.resizer=null},e}(),d=function(){function e(e,t){this.element=e,this.cb=t,this.hasTracked=!1}return e}(),c=function(){function e(){}return e.track=function(t,i){this.iframes.push(new d(t,i)),this.interval||(this.interval=setInterval((function(){e.checkClick()}),this.resolution))},e.checkClick=function(){if(document.activeElement){var e=document.activeElement;for(var t in this.iframes)e===this.iframes[t].element?0==this.iframes[t].hasTracked&&(this.iframes[t].cb.apply(window,[]),this.iframes[t].hasTracked=!0):this.iframes[t].hasTracked=!1}},e.resolution=200,e.iframes=[],e.interval=null,e}();function u(e,t){var i,s,r=e.root;function a(){var t=(new(0,e.getContents().constructor)).retain(1);e.updateContents(t)}r.addEventListener("click",(function(o){var d,c,u=o.target;o.target&&[!(null===(d=null==t?void 0:t.disableMediaTypes)||void 0===d?void 0:d.disableImages)&&"img",!(null===(c=null==t?void 0:t.disableMediaTypes)||void 0===c?void 0:c.disableVideos)&&"video"].includes(u.tagName.toLowerCase())&&e.isEnabled()&&(i=u,s=new l(u,r.parentElement,r,n(n({},t),{onChange:a})))})),e.on("text-change",(function(o,d){var u;!(null===(u=null==t?void 0:t.disableMediaTypes)||void 0===u?void 0:u.disableIframes)&&e.isEnabled()&&r.querySelectorAll("iframe").forEach((function(e){c.track(e,(function(){i=e,s=new l(e,r.parentElement,r,n(n({},t),{onChange:a}))}))}))})),document.addEventListener("mousedown",(function(e){var t,n,r,a=e.target;a===i||(null===(n=null===(t=null==s?void 0:s.resizer)||void 0===t?void 0:t.contains)||void 0===n?void 0:n.call(t,a))||(null===(r=null==s?void 0:s.destory)||void 0===r||r.call(s),s=null,i=null)}),{capture:!0})}return u}()),O.exports));f.register("modules/resize",$);class F extends h.Component{constructor(e){super(e),t(this,"handleChange",(e=>{this.setState({editorHtml:e}),this.props.onChange(e)})),t(this,"handleImageUpload",(()=>{const e=document.createElement("input");e.setAttribute("type","file"),e.setAttribute("accept","image/*"),e.click(),e.onchange=async()=>{var t;const i=e.files[0];if(i){const e=new FormData;e.append("file",i);try{const i=await fetch("/api/courses/qa/upload/image",{method:"POST",body:e}),n=await i.json(),s=null==(t=this.reactQuillRef.current)?void 0:t.getEditor();if(s){const e=s.getSelection(!0);s.insertEmbed(e.index,"image",n.url)}}catch(n){console.error("Error uploading image:",n),alert("Gagal mengunggah gambar. Coba lagi.")}}}})),this.state={editorHtml:e.value||""},this.reactQuillRef=m.createRef()}componentDidUpdate(e){e.value!==this.props.value&&this.setState({editorHtml:this.props.value})}render(){const{placeholder:e,height:t,classname:i}=this.props;return r.jsx("div",{className:"d-flex mb-2",style:{height:t},children:r.jsx(v,{ref:this.reactQuillRef,theme:"snow",value:this.state.editorHtml,onChange:this.handleChange,modules:F.modules(this.handleImageUpload),formats:F.formats,placeholder:e,style:{width:"100%"},className:`react-quill border bg-white rounded ${i}`})})}}F.modules=e=>({toolbar:{container:[[{header:"1"},{header:"2"},{font:[]}],[{size:[]}],["bold","italic","underline","strike","blockquote"],[{list:"ordered"},{list:"bullet"},{indent:"-1"},{indent:"+1"}],["link","image"],["clean"]],handlers:{image:e}},clipboard:{matchVisual:!1},resize:{modules:["Resize"]}}),F.formats=["header","font","size","bold","italic","underline","strike","blockquote","list","indent","link","image"],F.propTypes={placeholder:M.string,value:M.string,onChange:M.func.isRequired};const Y=({title:e,question:t,onTitleChange:i,onQuestionChange:n,onSubmit:s,isSubmitting:a,isEditing:o})=>r.jsxs("div",{className:"d-flex flex-column gap-2",children:[r.jsx("input",{type:"text",className:"form-control",placeholder:"Question title",value:e,onChange:e=>i(e.target.value)}),r.jsx(F,{value:t,onChange:n,placeholder:"Enter your question",height:"300px"}),a?r.jsxs("button",{className:"btn btn-sm btn-outline-primary",children:[r.jsx("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),r.jsx("span",{className:"visually-hidden",children:"Loading..."})]}):r.jsx("button",{className:"btn btn-sm btn-outline-primary",onClick:s,children:o?"Update Question":"Ask a question"})]}),U=({courseId:e,lectureId:t})=>{const{user:i}=n((e=>e.auth)),[s,c]=h.useState(""),[u,p]=h.useState(""),[m,g]=h.useState(t||""),[v,f]=h.useState(1),[b,x]=h.useState([]),[y,j]=h.useState(null),{data:w,isLoading:N}=a({courseId:e,lectureId:m,page:v,limit:10}),[z,{isLoading:T}]=o(),[S,{isLoading:C}]=l();return h.useEffect((()=>{e&&(async()=>{try{const t=await fetch(`/api/courses/lectures?courseId=${e}`),i=await t.json();x(i||[])}catch(t){console.error("Error fetching lectures:",t)}})()}),[e]),r.jsxs("div",{className:"p-4",children:[r.jsx(Y,{title:s,question:u,onTitleChange:c,onQuestionChange:p,onSubmit:async()=>{if(u.trim()){if(!m)return d.error("Please select a lecture");try{await z({id:y,courseId:e,lectureId:m,title:s,question:u}).unwrap(),p(""),c(""),j(null),d.success(y?"Question updated successfully":"Question added successfully")}catch(t){console.error("Failed to add question:",t),d.error("Failed to save question")}}},isSubmitting:T,isEditing:!!y}),r.jsx("div",{className:"my-3",children:r.jsx("input",{className:"form-control",placeholder:"Search all course questions"})}),r.jsx(k,{lectures:b,selectedLecture:m,onLectureChange:g}),r.jsx(E,{questions:(null==w?void 0:w.questions)||[],isLoading:N||C,currentUserId:i.id,onEdit:e=>{p(e.question),c(e.title),j(e.id)},onDelete:async e=>{try{await S(e).unwrap(),d.success("Question deleted successfully")}catch(t){console.error("Failed to delete question:",t),d.error("Failed to delete question")}},page:v,onPageChange:f})]})},Q=()=>r.jsxs("div",{className:"p-4",children:[r.jsx("h5",{className:"fw-bold mb-3",children:"Notes"}),r.jsx("div",{className:"text-muted",children:"No notes yet."})]}),W=[{key:"overview",label:"Overview"},{key:"qa",label:"Q&A"},{key:"notes",label:"Notes"}],B=()=>{const{id:e}=g(),{data:t,isLoading:i,error:n}=c(e),{data:s,isLoading:a}=u(e),[o,l]=h.useState(null),[d,p]=h.useState(null),[m,v]=h.useState("overview"),f=h.useMemo((()=>{if(!s)return{};const e={};return s.forEach((t=>{e[t.lecture_id]=t})),e}),[s]);if(i)return r.jsx("div",{className:"d-flex justify-content-center align-items-center min-vh-100",children:r.jsx("div",{className:"spinner-border text-primary",role:"status",children:r.jsx("span",{className:"visually-hidden",children:"Loading..."})})});if(n)return r.jsx("div",{className:"alert alert-danger m-5 text-center",role:"alert",children:"Error loading course content"});if(!t)return null;let b=null;for(const r of t.sections)if(r.lectures&&r.lectures.length>0){b=r.lectures[0];break}const x=o||b;(e=>{if(!e)return null;const t=e.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#&?]*).*/);t&&11===t[2].length&&t[2]})((null==x?void 0:x.video_url)||t.video_preview);return r.jsxs("div",{className:"container-fluid p-0 bg-light",children:[r.jsx("title",{children:t.title}),r.jsx("meta",{name:"description",content:t.description}),r.jsxs("div",{className:"bg-dark bg-opacity-75 d-flex justify-content-between align-items-center py-2 px-4",children:[r.jsx("h6",{className:"m-0 text-white",children:t.title}),r.jsx("div",{className:"d-flex align-items-center gap-2",children:r.jsxs("button",{className:"btn btn-outline-light",onClick:()=>window.location.href="/user-learning",children:[r.jsx("i",{className:"bi bi-house me-2"}),"Dashboard"]})})]}),r.jsxs("div",{className:"row g-0",children:[r.jsxs("div",{className:"col-lg-8 p-0",style:{minHeight:"100vh",background:"#fff"},children:[r.jsx(y,{lecture:o}),r.jsx(j,{TABS:W,activeTab:m,setActiveTab:v,renderTabContent:()=>"overview"===m?r.jsx(T,{data:t,formatDuration:N,formatPrice:z}):"qa"===m?r.jsx(U,{courseId:e,lectureId:null==x?void 0:x.id}):"notes"===m?r.jsx(Q,{}):null})]}),r.jsx("div",{className:"col-lg-4 bg-light p-0",style:{minHeight:"100vh",position:"sticky",top:0,zIndex:2},children:r.jsx(w,{sections:t.sections,expandedSection:d,setExpandedSection:p,selectedLecture:o,setSelectedLecture:l,formatDuration:N,lectureProgressMap:f})})]})]})};export{B as default};
//# sourceMappingURL=Learning-DG4O7WgI.js.map
