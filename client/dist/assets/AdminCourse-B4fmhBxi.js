import{j as e,D as s,Q as l,R as i,V as a}from"./index-BDg8PlU_.js";import{b as t}from"./vendor-BrtqdQb1.js";import{L as n}from"./Layout-mHBzCBF4.js";import{R as r}from"./quill.snow-BB4BC1RO.js";import{f as c,c as o}from"./format-8AmNs1tW.js";const d=({onSubmit:l,detail:i})=>{const[a,n]=t.useState({title:"",instructor:"",category:"",level:"Beginner",duration:"",price:"",description:"",thumbnail:null,video_preview:"",objectives:[""],requirements:[""],is_published:!1}),[d,m]=t.useState(""),[u,h]=t.useState(""),[b,p]=t.useState(!1);t.useEffect((()=>{var e,s;i&&(p(!0),n({id:i.id,title:i.title||"",instructor:i.instructor||"",category:i.category||"",level:i.level||"Beginner",duration:i.duration||"",price:i.price||"",description:i.description||"",thumbnail:null,video_preview:"null"===i.video_preview?"":i.video_preview||"",objectives:(null==(e=i.objectives)?void 0:e.length)?i.objectives:[""],requirements:(null==(s=i.requirements)?void 0:s.length)?i.requirements:[""],is_published:i.is_published||!1}),m(c(i.price)),h(i.thumbnail||""))}),[i]);const x=e=>{const{name:s,value:l,type:i,checked:a}=e.target;"price"===s?(e=>{const s=e.target.value,l=o(s);m(s),n((e=>({...e,price:l})))})(e):n((e=>({...e,[s]:"checkbox"===i?a:l})))},j=(e,s,l)=>{n((i=>({...i,[l]:i[l].map(((l,i)=>i===e?s:l))})))},v=e=>{n((s=>({...s,[e]:[...s[e],""]})))},g=(e,s)=>{n((l=>({...l,[s]:l[s].filter(((s,l)=>l!==e))})))};return e.jsx("div",{className:"modal fade",id:"course",tabIndex:"-1",children:e.jsx("div",{className:"modal-dialog modal-lg modal-dialog-scrollable",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",children:b?"Edit Course":"Add New Course"}),e.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal"})]}),e.jsx("div",{className:"modal-body",children:e.jsxs("form",{onSubmit:async e=>{e.preventDefault();try{if(!(b||a.thumbnail&&a.thumbnail instanceof File))return void s.error("Please select a thumbnail image");const e=new FormData;Object.keys(a).forEach((s=>{if("thumbnail"===s)a.thumbnail instanceof File&&e.append("thumbnail",a.thumbnail);else if("objectives"===s||"requirements"===s){const l=a[s].filter((e=>""!==e.trim()));e.append(s,JSON.stringify(l))}else"price"===s?e.append(s,o(a[s].toString())):"is_published"===s?e.append(s,a[s].toString()):e.append(s,a[s])})),await l(e,b?i.id:null),b||(n({id:"",title:"",instructor:"",category:"",level:"Beginner",duration:"",price:"",description:"",thumbnail:null,video_preview:"",objectives:[""],requirements:[""],is_published:!1}),m(""),h("")),document.querySelector('[data-bs-dismiss="modal"]').click()}catch(t){console.error("Error submitting form:",t),s.error(t.message||`Failed to ${b?"update":"create"} course`)}},children:[e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-12",children:e.jsx("input",{type:"text",className:"form-control",placeholder:"Course Title",name:"title",value:a.title,onChange:x,required:!0})}),e.jsx("div",{className:"col-md-6",children:e.jsx("input",{type:"text",className:"form-control",placeholder:"Instructor Name",name:"instructor",value:a.instructor,onChange:x,required:!0})}),e.jsx("div",{className:"col-md-4",children:e.jsxs("select",{className:"form-select",name:"category",value:a.category,onChange:x,required:!0,children:[e.jsx("option",{value:"",hidden:!0,children:"Category"}),e.jsx("option",{value:"Web Development",children:"Web Development"}),e.jsx("option",{value:"Excel",children:"Excel"}),e.jsx("option",{value:"Artificial Interlligence",children:"Artificial Intelligence"})]})}),e.jsx("div",{className:"col-md-4",children:e.jsxs("select",{className:"form-select",name:"level",value:a.level,onChange:x,required:!0,children:[e.jsx("option",{value:"",hidden:!0,children:"Level"}),e.jsx("option",{value:"Beginner",children:"Beginner"}),e.jsx("option",{value:"Intermediate",children:"Intermediate"}),e.jsx("option",{value:"Advance",children:"Advanced"}),e.jsx("option",{value:"All Levels",children:"All Levels"})]})}),e.jsx("div",{className:"col-md-4",children:e.jsx("input",{type:"number",className:"form-control",placeholder:"Duration (hours)",name:"duration",value:a.duration,onChange:x,required:!0})}),e.jsx("div",{className:"col-md-4",children:e.jsx("input",{type:"text",className:"form-control",placeholder:"Price",name:"price",value:d,onChange:x,onBlur:()=>{a.price&&m(c(a.price))},onFocus:()=>{m(a.price)},required:!0})}),e.jsx("div",{className:"col-12",children:e.jsx(r,{theme:"snow",value:a.description,onChange:e=>n((s=>({...s,description:e}))),placeholder:"Course Description"})}),e.jsxs("div",{className:"col-md-6",children:[e.jsxs("label",{className:"form-label",children:["Thumbnail Image"," ",!b&&e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"file",className:"form-control",name:"thumbnail",onChange:e=>{const{name:s,files:l}=e.target;if(l[0]){n((e=>({...e,[s]:l[0]})));const e=URL.createObjectURL(l[0]);h(e)}},accept:"image/*",required:!b}),u&&e.jsx("img",{src:u,alt:"Thumbnail preview",className:"mt-2 img-thumbnail",style:{maxHeight:"100px"}})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Preview Video"}),e.jsx("input",{type:"text",className:"form-control",name:"video_preview",value:a.video_preview,onChange:x,required:!0})]}),e.jsxs("div",{className:"col-12",children:[e.jsx("label",{className:"form-label",children:"Learning Objectives"}),a.objectives.map(((s,l)=>e.jsxs("div",{className:"input-group mb-2",children:[e.jsx("input",{type:"text",className:"form-control",value:s,onChange:e=>j(l,e.target.value,"objectives"),placeholder:"What will students learn?"}),e.jsx("button",{type:"button",className:"btn btn-outline-danger",onClick:()=>g(l,"objectives"),disabled:1===a.objectives.length,children:e.jsx("i",{className:"bi bi-trash"})})]},l))),e.jsxs("button",{type:"button",className:"btn btn-sm btn-outline-primary",onClick:()=>v("objectives"),children:[e.jsx("i",{className:"bi bi-plus-lg"})," Add Objective"]})]}),e.jsxs("div",{className:"col-12",children:[e.jsx("label",{className:"form-label",children:"Requirements"}),a.requirements.map(((s,l)=>e.jsxs("div",{className:"input-group mb-2",children:[e.jsx("input",{type:"text",className:"form-control",value:s,onChange:e=>j(l,e.target.value,"requirements"),placeholder:"What do students need?"}),e.jsx("button",{type:"button",className:"btn btn-outline-danger",onClick:()=>g(l,"requirements"),disabled:1===a.requirements.length,children:e.jsx("i",{className:"bi bi-trash"})})]},l))),e.jsxs("button",{type:"button",className:"btn btn-sm btn-outline-primary",onClick:()=>v("requirements"),children:[e.jsx("i",{className:"bi bi-plus-lg"})," Add Requirement"]})]}),e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"form-check",children:[e.jsx("input",{type:"checkbox",className:"form-check-input",id:"isPublished",name:"is_published",checked:a.is_published,onChange:x}),e.jsx("label",{className:"form-check-label",htmlFor:"isPublished",children:"Publish course immediately"})]})})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:b?"Update Course":"Create Course"})]})]})})]})})})},m=()=>{var s;const{data:r=[],isLoading:c,error:o}=l(),[m,u]=t.useState({}),[h]=i(),b=async e=>{var s;try{const s=await h(e).unwrap();a.success(s.message)}catch(l){console.error("Error details:",l),a.error((null==(s=l.data)?void 0:s.error)||"Failed to create course")}};return c?e.jsx(n,{title:"Admin Course",children:e.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"60vh"},children:e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})})})}):o?e.jsx(n,{title:"Admin Course",children:e.jsxs("div",{className:"alert alert-danger",role:"alert",children:["Error loading courses: ",(null==(s=o.data)?void 0:s.message)||"Something went wrong"]})}):0===r.length?e.jsxs(n,{title:"Admin Course",children:[e.jsx("div",{className:"text-end mb-3",children:e.jsxs("button",{className:"btn btn-sm btn-outline-primary","data-bs-toggle":"modal","data-bs-target":"#course",children:[e.jsx("i",{className:"bi bi-plus-lg me-2"}),"Course"]})}),e.jsx("div",{className:"alert alert-info",role:"alert",children:"No courses found."}),e.jsx(d,{onSubmit:b,detail:m})]}):e.jsxs(n,{title:"Admin Course",children:[e.jsx("div",{className:"text-end mb-3",children:e.jsxs("button",{className:"btn btn-sm btn-outline-primary","data-bs-toggle":"modal","data-bs-target":"#course",children:[e.jsx("i",{className:"bi bi-plus-lg me-2"}),"Course"]})}),e.jsx("div",{className:"row g-2",children:r.map((s=>e.jsx("div",{className:"col-12 col-md-6 col-lg-4",children:e.jsxs("div",{className:"card h-100 border-0 shadow-sm",children:[e.jsx("img",{src:s.thumbnail||"https://via.placeholder.com/600x400",className:"card-img-top",alt:s.title,style:{height:"200px",objectFit:"cover"}}),e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-2",children:[e.jsx("span",{className:"badge "+(s.is_published?"bg-success":"bg-warning"),children:s.is_published?"Published":"Draft"}),e.jsxs("div",{className:"dropdown",children:[e.jsx("button",{className:"btn btn-link text-dark p-0",type:"button","data-bs-toggle":"dropdown",children:e.jsx("i",{className:"bi bi-three-dots-vertical"})}),e.jsxs("ul",{className:"dropdown-menu dropdown-menu-end",children:[e.jsx("li",{children:e.jsxs("button",{className:"dropdown-item",onClick:()=>u(s),"data-bs-toggle":"modal","data-bs-target":"#course",children:[e.jsx("i",{className:"bi bi-pencil-square me-2"}),"Edit"]})}),e.jsx("li",{children:e.jsxs("button",{className:"dropdown-item text-danger",children:[e.jsx("i",{className:"bi bi-trash me-2"}),"Delete"]})})]})]})]}),e.jsx("h5",{className:"card-title mb-1",children:s.title}),e.jsxs("p",{className:"text-muted small mb-2",children:["by ",s.instructor]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("span",{className:"badge bg-info me-2",children:s.category}),e.jsx("span",{className:"badge bg-secondary me-2",children:s.level}),e.jsxs("span",{className:"badge bg-light text-dark",children:[e.jsx("i",{className:"bi bi-clock me-1"}),s.duration," hours"]})]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("i",{className:"bi bi-people me-2"}),e.jsx("span",{children:"0 students"})]}),e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("i",{className:"bi bi-star-fill text-warning me-1"}),e.jsx("span",{children:"0 (0 reviews)"})]})]}),e.jsxs("h6",{className:"mb-0 fw-bold",children:["Rp ",parseFloat(s.price).toLocaleString()]})]})]})},s.id)))}),e.jsx(d,{onSubmit:b,detail:m})]})};export{m as default};
//# sourceMappingURL=AdminCourse-B4fmhBxi.js.map
