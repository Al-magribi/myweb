import{C as e,j as a,D as s,E as i,G as l,H as t,I as r,S as n,N as d,A as c}from"./index-CQuOBoKr.js";import{b as o,c as m,R as u}from"./vendor-BrtqdQb1.js";const h=({product:i})=>{const[l,t]=o.useState({name:"",email:"",phone:""}),[r,{isLoading:n,data:d,isSuccess:c,error:m,isError:u,reset:h}]=e(),v=()=>{t({name:"",email:"",phone:""})};return o.useEffect((()=>{if(c){window.fbq&&window.fbq("track","Purchase",{value:i.price,currency:"IDR",content_name:i.name,content_ids:[i.id],content_type:"product",num_items:1}),t({name:"",email:"",phone:""}),h();document.querySelector("[data-bs-dismiss='modal']").click(),window.location.href=d.redirect_url}u&&(h(),console.log(m))}),[c,u,m]),a.jsx("div",{className:"modal fade",id:"order","data-bs-backdrop":"static","data-bs-keyboard":"false",tabIndex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true",children:a.jsx("div",{className:"modal-dialog",children:a.jsxs("div",{className:"modal-content",children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h1",{className:"modal-title fs-5",id:"staticBackdropLabel",children:"Customer Details"}),a.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:v})]}),a.jsx("div",{className:"modal-body",children:a.jsxs("div",{className:"d-flex flex-column gap-3",children:[a.jsxs("div",{className:"form-floating",children:[a.jsx("input",{type:"text",className:"form-control",placeholder:"Full Name",value:l.name,onChange:e=>t({...l,name:e.target.value})}),a.jsx("label",{htmlFor:"name",children:"Full Name"})]}),a.jsxs("div",{className:"form-floating",children:[a.jsx("input",{type:"email",className:"form-control",placeholder:"Email Address",value:l.email,onChange:e=>t({...l,email:e.target.value})}),a.jsx("label",{htmlFor:"email",children:"Email Address"})]}),a.jsxs("div",{className:"form-floating",children:[a.jsx("input",{type:"text",className:"form-control",placeholder:"Whatsapp",value:l.phone,onChange:e=>t({...l,phone:e.target.value})}),a.jsx("label",{htmlFor:"phone",children:"Whatsapp"})]})]})}),a.jsxs("div",{className:"modal-footer",children:[a.jsx("button",{type:"button",className:"btn btn-outline-danger","data-bs-dismiss":"modal",onClick:v,children:"Cancel"}),a.jsx("button",{type:"button",className:"btn btn-primary",disabled:n,onClick:()=>{var e;if(!l.name||!l.email||!l.phone)return void s.error("Please fill in all fields");window.fbq&&window.fbq("track","InitiateCheckout",{content_name:i.name,content_ids:[i.id],content_type:"product",value:i.price,currency:"IDR"});const a={name:l.name,email:l.email,phone:l.phone,productid:i.id,quantity:1,url:window.location.href};s.promise(r(a).unwrap(),{loading:"Memproses Pemesanan...",success:"Pemesanan Berhasil",error:(null==(e=null==m?void 0:m.data)?void 0:e.message)||"Pemesanan Gagal"})},children:"Process Order"})]})]})})})},v=()=>{const{id:e}=m(),[l,t]=o.useState({productId:e,name:"",email:"",rating:0,reviewComment:""}),[r,n]=o.useState({}),[d,{isLoading:c,isSuccess:u,isError:h,reset:v}]=i(),b=e=>{const{name:a,value:s}=e.target;t({...l,[a]:s}),r[a]&&n({...r,[a]:""})};return o.useEffect((()=>{u&&(t({productId:e,name:"",email:"",rating:0,reviewComment:""}),n({}),v()),h&&v()}),[u,h]),a.jsx("div",{className:"card",children:a.jsxs("div",{className:"card-body",children:[a.jsx("h5",{className:"card-title mb-3",children:"Write a Review"}),a.jsxs("form",{onSubmit:async e=>{e.preventDefault(),(()=>{const e={};return l.name.trim()||(e.name="Name is required"),l.email.trim()?/\S+@\S+\.\S+/.test(l.email)||(e.email="Email is invalid"):e.email="Email is required",l.rating||(e.rating="Please select a rating"),l.reviewComment.trim()||(e.reviewComment="Review comment is required"),n(e),0===Object.keys(e).length})()&&s.promise(d(l).unwrap().then((e=>e.message)),{loading:"Submitting review...",success:e=>e,error:e=>e.data.message})},children:[a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"form-label",children:"Rating"}),a.jsx("div",{className:"rating-select",children:[1,2,3,4,5].map((e=>a.jsx("i",{className:`bi ${e<=l.rating?"bi-star-fill":"bi-star"} fs-4 me-2 text-warning`,style:{cursor:"pointer"},onClick:()=>{return a=e,t({...l,rating:a}),void(r.rating&&n({...r,rating:""}));var a}},e)))}),r.rating&&a.jsx("div",{className:"text-danger mt-1",children:r.rating})]}),a.jsxs("div",{className:"form-floating mb-3",children:[a.jsx("input",{type:"text",className:"form-control "+(r.name?"is-invalid":""),id:"name",placeholder:"Enter your name",name:"name",value:l.name,onChange:b}),a.jsx("label",{htmlFor:"name",children:"Your Name"}),r.name&&a.jsx("div",{className:"invalid-feedback",children:r.name})]}),a.jsxs("div",{className:"form-floating mb-3",children:[a.jsx("input",{type:"email",className:"form-control "+(r.email?"is-invalid":""),id:"email",placeholder:"Enter your email",name:"email",value:l.email,onChange:b}),a.jsx("label",{htmlFor:"email",children:"Your Email"}),r.email&&a.jsx("div",{className:"invalid-feedback",children:r.email})]}),a.jsxs("div",{className:"form-floating mb-3",children:[a.jsx("textarea",{className:"form-control "+(r.reviewComment?"is-invalid":""),id:"reviewComment",rows:"3",name:"reviewComment",placeholder:"Write your review here...",value:l.reviewComment,onChange:b}),a.jsx("label",{htmlFor:"reviewComment",children:"Your Review"}),r.reviewComment&&a.jsx("div",{className:"invalid-feedback",children:r.reviewComment})]}),a.jsx("button",{type:"submit",className:"btn btn-primary",children:"Submit Review"})]})]})})},b=({isReviewLoading:e,reviewData:s,reviewPage:i,setReviewPage:l,reviewLimit:t})=>{const r=e=>{const s=[],i=Math.floor(e),l=e%1!=0;for(let r=0;r<i;r++)s.push(a.jsx("i",{className:"bi bi-star-fill text-warning"},`full-${r}`));l&&s.push(a.jsx("i",{className:"bi bi-star-half text-warning"},"half"));const t=5-Math.ceil(e);for(let r=0;r<t;r++)s.push(a.jsx("i",{className:"bi bi-star text-warning"},`empty-${r}`));return s};return a.jsx("div",{children:e?a.jsx("div",{className:"text-center py-4",children:a.jsx("div",{className:"spinner-border text-primary",role:"status",children:a.jsx("span",{className:"visually-hidden",children:"Loading..."})})}):s&&s.reviews.length>0?a.jsxs(a.Fragment,{children:[s.reviews.map((e=>a.jsx("div",{className:"card mb-3",children:a.jsxs("div",{className:"card-body",children:[a.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[a.jsx("div",{children:a.jsx("h6",{className:"mb-0",children:e.name})}),a.jsx("div",{className:"text-warning",children:r(e.rating)})]}),e.comment&&a.jsx("p",{className:"card-text mb-0",children:e.comment})]})},e.id))),a.jsx("nav",{className:"mt-3",children:a.jsxs("ul",{className:"pagination pagination-sm justify-content-center",children:[a.jsx("li",{className:"page-item "+(1===i?"disabled":""),children:a.jsx("button",{className:"page-link",onClick:()=>l(1),disabled:1===i,children:a.jsx("i",{className:"bi bi-chevron-bar-left"})})}),a.jsx("li",{className:"page-item "+(1===i?"disabled":""),children:a.jsx("button",{className:"page-link",onClick:()=>l(i-1),disabled:1===i,children:a.jsx("i",{className:"bi bi-chevron-double-left"})})}),(()=>{const e=Math.ceil((s.total||0)/t);let r=Math.max(1,i-2),n=Math.min(e,i+2);n-r<4&&(1===r?n=Math.min(e,r+4):n===e&&(r=Math.max(1,n-4)));const d=[];for(let a=r;a<=n;a++)d.push(a);return d.map((e=>a.jsx("li",{className:"page-item "+(i===e?"active":""),children:a.jsx("button",{className:"page-link",onClick:()=>l(e),children:e})},e)))})(),a.jsx("li",{className:"page-item "+(i===Math.ceil((s.total||0)/t)?"disabled":""),children:a.jsx("button",{className:"page-link",onClick:()=>l(i+1),disabled:i===Math.ceil((s.total||0)/t),children:a.jsx("i",{className:"bi bi-chevron-double-right"})})}),a.jsx("li",{className:"page-item "+(i===Math.ceil((s.total||0)/t)?"disabled":""),children:a.jsx("button",{className:"page-link",onClick:()=>l(Math.ceil((s.total||0)/t)),disabled:i===Math.ceil((s.total||0)/t),children:a.jsx("i",{className:"bi bi-chevron-bar-right"})})})]})})]}):a.jsx("div",{className:"text-center py-4",children:a.jsx("p",{className:"text-muted mb-0",children:"No reviews yet"})})})},x=()=>{const{id:e}=m(),[i,t]=o.useState(""),[r,n]=o.useState(""),[d,c]=o.useState(!1),[u,{isLoading:h,isError:v,isSuccess:b,error:x,data:g,reset:p}]=l();return o.useEffect((()=>{b&&(p(),n(g.message),c(!0)),v&&(p(),n(x.data.message),c(!1))}),[b,v,g,x]),a.jsx("div",{className:"modal fade",id:"checkPayment","data-bs-backdrop":"static","data-bs-keyboard":"false",tabIndex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true",children:a.jsx("div",{className:"modal-dialog modal-dialog-centered",children:a.jsxs("div",{className:"modal-content shadow-lg",children:[a.jsxs("div",{className:"modal-header border-bottom-0 pb-0",children:[a.jsx("h1",{className:"modal-title fs-4 fw-bold text-primary",id:"staticBackdropLabel",children:"Check Payment Status"}),a.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),a.jsx("div",{className:"modal-body pt-4",children:a.jsxs("form",{onSubmit:a=>{a.preventDefault();const l={email:i,productid:e};s.promise(u(l).unwrap().then((e=>e.message)),{loading:"Checking...",success:"Payment checked",error:"Payment not found"})},children:[a.jsxs("div",{className:"form-floating mb-4",children:[a.jsx("input",{type:"email",className:"form-control form-control-lg",id:"email",placeholder:"Enter Email",required:!0,value:i,onChange:e=>t(e.target.value)}),a.jsx("label",{htmlFor:"email",className:"text-muted",children:"Email Address"})]}),r&&a.jsxs("div",{className:`alert ${d?"alert-success":"alert-danger"} mb-4`,role:"alert",children:[a.jsx("i",{className:`bi ${d?"bi-check-circle":"bi-exclamation-circle"} me-2`}),r]}),a.jsx("button",{type:"submit",className:"btn btn-primary btn-lg w-100 py-3",disabled:h,children:h?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Checking..."]}):"Check Payment"})]})})]})})})},g=()=>{var e,s,i,l,o,g;const{id:p}=m(),{data:j,isLoading:N,error:w}=t(p),[f,y]=u.useState(1),{data:k,isLoading:C,error:S}=r({productId:p,page:f,limit:10}),P=j?{title:j.name,description:null==(e=j.description)?void 0:e.replace(/<[^>]*>/g,"").slice(0,160),keywords:`${j.name}, web development, online course, ${null==(s=j.features)?void 0:s.join(", ")}`,ogTitle:j.name,ogDescription:null==(i=j.description)?void 0:i.replace(/<[^>]*>/g,"").slice(0,160),ogImage:j.image,structuredData:{"@context":"https://schema.org","@type":"Product",name:j.name,description:null==(l=j.description)?void 0:l.replace(/<[^>]*>/g,""),image:j.image,offers:{"@type":"Offer",price:j.price,priceCurrency:"IDR",availability:"https://schema.org/InStock",url:window.location.href},aggregateRating:{"@type":"AggregateRating",ratingValue:j.rating||"0",reviewCount:j.reviewcount||"0"},review:null==(o=null==k?void 0:k.reviews)?void 0:o.map((e=>({"@type":"Review",reviewRating:{"@type":"Rating",ratingValue:e.rating},author:{"@type":"Person",name:e.name},reviewBody:e.comment})))}}:{title:"Loading Product - ALMADEV",description:"Loading product details..."},L=e=>{const s=[],i=Math.floor(e),l=e%1!=0;for(let r=0;r<i;r++)s.push(a.jsx("i",{className:"bi bi-star-fill text-warning"},`full-${r}`));l&&s.push(a.jsx("i",{className:"bi bi-star-half text-warning"},"half"));const t=5-Math.ceil(e);for(let r=0;r<t;r++)s.push(a.jsx("i",{className:"bi bi-star text-warning"},`empty-${r}`));return s},R=(e,s,i)=>{const l=i>0?s/i*100:0;return a.jsxs("div",{className:"d-flex align-items-center mb-2",children:[a.jsxs("div",{className:"me-2",style:{width:"60px"},children:[e," stars"]}),a.jsx("div",{className:"progress flex-grow-1",style:{height:"8px"},children:a.jsx("div",{className:"progress-bar bg-warning",role:"progressbar",style:{width:`${l}%`},"aria-valuenow":l,"aria-valuemin":"0","aria-valuemax":"100"})}),a.jsx("div",{className:"ms-2",style:{width:"40px"},children:s})]})};return a.jsxs("div",{className:"bg-light",children:[a.jsx(n,{...P}),a.jsx(d,{}),a.jsx("main",{className:"container py-4",style:{marginTop:80},children:a.jsxs("div",{className:"row",children:[a.jsx("div",{className:"col-12 d-md-none mb-4",children:a.jsx("img",{src:null==j?void 0:j.image,alt:null==j?void 0:j.name,className:"img-fluid rounded border border-2",style:{width:"100%",height:"auto"}})}),a.jsxs("div",{className:"col-md-6 mb-4 order-md-1 order-3",children:[a.jsx("div",{className:"d-none d-md-block",children:a.jsx("img",{src:null==j?void 0:j.image,alt:null==j?void 0:j.name,className:"img-fluid rounded border border-2 mb-4",style:{width:"100%",height:"auto"}})}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h4",{className:"mb-3",children:"Customer Reviews"}),a.jsx("div",{className:"card mb-4",children:a.jsx("div",{className:"card-body",children:a.jsxs("div",{className:"row align-items-center",children:[a.jsxs("div",{className:"col-md-4 text-center",children:[a.jsx("h2",{className:"display-4 mb-0",children:Number(null==j?void 0:j.rating).toFixed(1)}),a.jsx("div",{className:"mb-2",children:L(null==j?void 0:j.rating)}),a.jsxs("p",{className:"text-muted mb-0",children:[null==j?void 0:j.reviewcount," reviews"]})]}),a.jsx("div",{className:"col-md-8",children:a.jsxs("div",{className:"rating-breakdown",children:[R(5,null==j?void 0:j.ratingBreakdown[5],(null==j?void 0:j.reviewCount)||(null==j?void 0:j.reviewcount)||0),R(4,null==j?void 0:j.ratingBreakdown[4],(null==j?void 0:j.reviewCount)||(null==j?void 0:j.reviewcount)||0),R(3,null==j?void 0:j.ratingBreakdown[3],(null==j?void 0:j.reviewCount)||(null==j?void 0:j.reviewcount)||0),R(2,null==j?void 0:j.ratingBreakdown[2],(null==j?void 0:j.reviewCount)||(null==j?void 0:j.reviewcount)||0),R(1,null==j?void 0:j.ratingBreakdown[1],(null==j?void 0:j.reviewCount)||(null==j?void 0:j.reviewcount)||0)]})})]})})}),a.jsx(b,{isReviewLoading:C,reviewData:k,reviewPage:f,setReviewPage:y,reviewLimit:10})]})]}),a.jsxs("div",{className:"col-md-6 bg-white p-4 rounded-3 border border-2 order-md-2 order-2",children:[a.jsx("h1",{className:"mb-3",children:null==j?void 0:j.name}),a.jsxs("h2",{className:"text-primary mb-4",children:["Rp ",parseFloat(null==j?void 0:j.price).toLocaleString("id-ID")]}),a.jsxs("div",{className:"d-flex align-items-center mb-3",children:[a.jsx("div",{className:"me-2",children:L(null==j?void 0:j.rating)}),a.jsx("span",{className:"me-2",children:Number(null==j?void 0:j.rating).toFixed(1)}),a.jsxs("span",{className:"text-muted",children:["(",null==j?void 0:j.reviewcount," reviews)"]})]}),a.jsxs("div",{className:"text-success mb-4",children:[a.jsx("i",{className:"bi bi-graph-up-arrow me-1"}),(Number(null==j?void 0:j.totalsales)+240).toLocaleString("id-ID")," ","sold"]}),a.jsx("div",{className:"text-muted mb-4",dangerouslySetInnerHTML:(E=null==j?void 0:j.description,{__html:E})}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h4",{children:"Key Features"}),a.jsx("ul",{className:"list-unstyled",children:null==(g=null==j?void 0:j.features)?void 0:g.map(((e,s)=>a.jsxs("li",{className:"mb-2",children:[a.jsx("i",{className:"bi bi-check-circle-fill text-success me-2"}),e]},s)))})]}),a.jsxs("div",{className:"d-grid gap-2 mb-4",children:[a.jsx("button",{"data-bs-toggle":"modal","data-bs-target":"#order",className:"btn btn-success btn-lg",children:"Buy Now"}),a.jsx("button",{className:"btn btn-outline-warning btn-lg","data-bs-toggle":"modal","data-bs-target":"#checkPayment",children:"Check Payment"})]}),a.jsx(v,{})]})]})}),a.jsx(h,{product:j}),a.jsx(x,{}),a.jsx(c,{})]});var E};export{g as default};
//# sourceMappingURL=Detail-C3VAHJiO.js.map
