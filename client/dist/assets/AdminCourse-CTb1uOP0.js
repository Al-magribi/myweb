import{j as e,e as s,i as l,k as i,V as a}from"./index-CZtzjuKv.js";import{b as t,u as r}from"./vendor-CCW8Is9m.js";import{L as n}from"./Layout--3eDNL6g.js";import{R as c}from"./quill.snow-C8zidYNu.js";import{f as d,c as o}from"./format-8AmNs1tW.js";const m=({onSubmit:l,detail:i})=>{const[a,r]=t.useState({title:"",instructor:"",category:"",level:"",duration:"",price:"",description:"",thumbnail:null,video_preview:"",link_files:"",objectives:[""],requirements:[""],is_published:!1}),[n,m]=t.useState(""),[u,b]=t.useState(""),[h,x]=t.useState(!1);t.useEffect((()=>{var e,s;i&&(x(!0),r({id:i.id,title:i.title||"",instructor:i.instructor||"",category:i.category||"",level:i.level||"Beginner",duration:i.duration||"",price:i.price||"",description:i.description||"",thumbnail:null,video_preview:"null"===i.video_preview?"":i.video_preview||"",link_files:i.link_files||"",objectives:(null==(e=i.objectives)?void 0:e.length)?i.objectives:[""],requirements:(null==(s=i.requirements)?void 0:s.length)?i.requirements:[""],is_published:i.is_published||!1}),m(d(i.price)),b(i.thumbnail||""))}),[i]);const p=e=>{const{name:s,value:l,type:i,checked:a}=e.target;"price"===s?(e=>{const s=e.target.value,l=o(s);m(s),r((e=>({...e,price:l})))})(e):r((e=>({...e,[s]:"checkbox"===i?a:l})))},j=(e,s,l)=>{r((i=>({...i,[l]:i[l].map(((l,i)=>i===e?s:l))})))},v=e=>{r((s=>({...s,[e]:[...s[e],""]})))},g=(e,s)=>{r((l=>({...l,[s]:l[s].filter(((s,l)=>l!==e))})))},N=()=>{r({id:"",title:"",instructor:"",category:"",level:"Beginner",duration:"",price:"",description:"",thumbnail:null,video_preview:"",link_files:"",objectives:[""],requirements:[""],is_published:!1}),x(!1)};return e.jsx("div",{className:"modal fade",id:"course",tabIndex:"-1",children:e.jsx("div",{className:"modal-dialog modal-lg modal-dialog-scrollable",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header bg-light",children:[e.jsx("h5",{className:"modal-title fw-bold",children:h?"Edit Course":"Add New Course"}),e.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal",onClick:N})]}),e.jsx("div",{className:"modal-body p-4",children:e.jsxs("form",{onSubmit:async e=>{e.preventDefault();try{if(!(h||a.thumbnail&&a.thumbnail instanceof File))return void s.error("Please select a thumbnail image");const e=new FormData;Object.keys(a).forEach((s=>{if("thumbnail"===s)a.thumbnail instanceof File&&e.append("thumbnail",a.thumbnail);else if("objectives"===s||"requirements"===s){const l=a[s].filter((e=>""!==e.trim()));e.append(s,JSON.stringify(l))}else"price"===s?e.append(s,o(a[s].toString())):"is_published"===s?e.append(s,a[s].toString()):e.append(s,a[s])})),await l(e,h?i.id:null),h||(r({id:"",title:"",instructor:"",category:"",level:"Beginner",duration:"",price:"",description:"",thumbnail:null,video_preview:"",link_files:"",objectives:[""],requirements:[""],is_published:!1}),m(""),b("")),document.querySelector('[data-bs-dismiss="modal"]').click()}catch(t){console.error("Error submitting form:",t),s.error(t.message||`Failed to ${h?"update":"create"} course`)}},children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h6",{className:"text-primary mb-3 fw-bold",children:"Basic Information"}),e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-12",children:[e.jsx("label",{className:"form-label",children:"Course Title"}),e.jsx("input",{type:"text",className:"form-control form-control-lg",placeholder:"Enter course title",name:"title",value:a.title,onChange:p,required:!0})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Instructor"}),e.jsx("input",{type:"text",className:"form-control",placeholder:"Enter instructor name",name:"instructor",value:a.instructor,onChange:p,required:!0})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Category"}),e.jsxs("select",{className:"form-select",name:"category",value:a.category,onChange:p,required:!0,children:[e.jsx("option",{value:"",hidden:!0,children:"Select Category"}),e.jsx("option",{value:"Web Development",children:"Web Development"}),e.jsx("option",{value:"Excel",children:"Excel"}),e.jsx("option",{value:"Artificial Interlligence",children:"Artificial Intelligence"})]})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsx("label",{className:"form-label",children:"Level"}),e.jsxs("select",{className:"form-select",name:"level",value:a.level,onChange:p,required:!0,children:[e.jsx("option",{value:"",hidden:!0,children:"Select Level"}),e.jsx("option",{value:"Beginner",children:"Beginner"}),e.jsx("option",{value:"Intermediate",children:"Intermediate"}),e.jsx("option",{value:"Advance",children:"Advanced"}),e.jsx("option",{value:"All Levels",children:"All Levels"})]})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsx("label",{className:"form-label",children:"Duration (hours)"}),e.jsx("input",{type:"number",className:"form-control",placeholder:"Enter duration",name:"duration",value:a.duration,onChange:p,required:!0})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsx("label",{className:"form-label",children:"Price"}),e.jsx("input",{type:"text",className:"form-control",placeholder:"Enter price",name:"price",value:n,onChange:p,onBlur:()=>{a.price&&m(d(a.price))},onFocus:()=>{m(a.price)},required:!0})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h6",{className:"text-primary mb-3 fw-bold",children:"Course Media"}),e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsxs("label",{className:"form-label d-block",children:["Thumbnail Image"," ",!h&&e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs("div",{className:"d-flex gap-3 align-items-start",children:[u&&e.jsx("img",{src:u,alt:"Thumbnail preview",className:"rounded",style:{width:"120px",height:"80px",objectFit:"cover"}}),e.jsxs("div",{className:"flex-grow-1",children:[e.jsx("input",{type:"file",className:"form-control",name:"thumbnail",onChange:e=>{const{name:s,files:l}=e.target;if(l[0]){r((e=>({...e,[s]:l[0]})));const e=URL.createObjectURL(l[0]);b(e)}},accept:"image/*",required:!h}),e.jsx("small",{className:"text-muted",children:"Recommended size: 1280x720px"})]})]})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Preview Video URL"}),e.jsx("input",{type:"text",className:"form-control",name:"video_preview",placeholder:"Enter video URL",value:a.video_preview,onChange:p,required:!0}),e.jsx("small",{className:"text-muted",children:"YouTube or Vimeo URL"})]}),e.jsxs("div",{className:"col-12",children:[e.jsx("label",{className:"form-label",children:"Course Files Link"}),e.jsx("input",{type:"text",className:"form-control",name:"link_files",placeholder:"Enter course files URL (Google Drive, Dropbox, etc.)",value:a.link_files,onChange:p})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h6",{className:"text-primary mb-3 fw-bold",children:"Course Description"}),e.jsx("div",{className:"bg-light rounded p-3",children:e.jsx(c,{theme:"snow",value:a.description,onChange:e=>r((s=>({...s,description:e}))),placeholder:"Enter detailed course description"})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h6",{className:"text-primary mb-3 fw-bold",children:"Learning Objectives"}),e.jsxs("div",{className:"bg-light rounded p-3",children:[a.objectives.map(((s,l)=>e.jsxs("div",{className:"input-group mb-2",children:[e.jsx("span",{className:"input-group-text bg-white",children:e.jsx("i",{className:"bi bi-check-circle text-primary"})}),e.jsx("input",{type:"text",className:"form-control",value:s,onChange:e=>j(l,e.target.value,"objectives"),placeholder:"What will students learn?"}),e.jsx("button",{type:"button",className:"btn btn-outline-danger",onClick:()=>g(l,"objectives"),disabled:1===a.objectives.length,children:e.jsx("i",{className:"bi bi-trash"})})]},l))),e.jsxs("button",{type:"button",className:"btn btn-sm btn-outline-primary mt-2",onClick:()=>v("objectives"),children:[e.jsx("i",{className:"bi bi-plus-lg me-1"})," Add Learning Objective"]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h6",{className:"text-primary mb-3 fw-bold",children:"Course Requirements"}),e.jsxs("div",{className:"bg-light rounded p-3",children:[a.requirements.map(((s,l)=>e.jsxs("div",{className:"input-group mb-2",children:[e.jsx("span",{className:"input-group-text bg-white",children:e.jsx("i",{className:"bi bi-asterisk text-primary"})}),e.jsx("input",{type:"text",className:"form-control",value:s,onChange:e=>j(l,e.target.value,"requirements"),placeholder:"What do students need?"}),e.jsx("button",{type:"button",className:"btn btn-outline-danger",onClick:()=>g(l,"requirements"),disabled:1===a.requirements.length,children:e.jsx("i",{className:"bi bi-trash"})})]},l))),e.jsxs("button",{type:"button",className:"btn btn-sm btn-outline-primary mt-2",onClick:()=>v("requirements"),children:[e.jsx("i",{className:"bi bi-plus-lg me-1"})," Add Requirement"]})]})]}),e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"form-check form-switch",children:[e.jsx("input",{type:"checkbox",className:"form-check-input",id:"isPublished",name:"is_published",checked:a.is_published,onChange:p}),e.jsx("label",{className:"form-check-label",htmlFor:"isPublished",children:"Publish course immediately"})]})}),e.jsxs("div",{className:"modal-footer px-0 pb-0",children:[e.jsx("button",{type:"button",className:"btn btn-sm btn-danger","data-bs-dismiss":"modal",onClick:N,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-sm btn-primary",children:h?"Update Course":"Create Course"})]})]})})]})})})},u=()=>{var s;const c=r(),{data:d=[],isLoading:o,error:u}=l(),[b,h]=t.useState({}),[x]=i();function p(e){if(!e||isNaN(e))return"00:00";const s=Math.floor(e/3600),l=Math.floor(e%3600/60),i=e%60;return s>0?`${s.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}`:`${l.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}`}const j=async e=>{var s;try{const s=await x(e).unwrap();a.success(s.message)}catch(l){console.error("Error details:",l),a.error((null==(s=l.data)?void 0:s.error)||"Failed to create course")}};return o?e.jsx(n,{title:"Admin Course",children:e.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"60vh"},children:e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})})})}):u?e.jsx(n,{title:"Admin Course",children:e.jsxs("div",{className:"alert alert-danger",role:"alert",children:["Error loading courses: ",(null==(s=u.data)?void 0:s.message)||"Something went wrong"]})}):0===d.length?e.jsxs(n,{title:"Admin Course",children:[e.jsx("div",{className:"text-end mb-3",children:e.jsxs("button",{className:"btn btn-sm btn-outline-primary","data-bs-toggle":"modal","data-bs-target":"#course",children:[e.jsx("i",{className:"bi bi-plus-lg me-2"}),"Course"]})}),e.jsx("div",{className:"alert alert-info",role:"alert",children:"No courses found."}),e.jsx(m,{onSubmit:j,detail:b})]}):e.jsxs(n,{title:"Admin Course",children:[e.jsx("div",{className:"text-end mb-3",children:e.jsxs("button",{className:"btn btn-sm btn-outline-primary","data-bs-toggle":"modal","data-bs-target":"#course",children:[e.jsx("i",{className:"bi bi-plus-lg me-2"}),"Course"]})}),e.jsx("div",{className:"row g-2",children:d.map((s=>e.jsx("div",{className:"col-12 col-md-6 col-lg-4",children:e.jsxs("div",{className:"card h-100 border-0 shadow-sm",children:[e.jsx("img",{src:s.thumbnail||"https://via.placeholder.com/600x400",className:"card-img-top",alt:s.title,style:{height:"200px",objectFit:"cover"}}),e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-2",children:[e.jsx("span",{className:"badge "+(s.is_published?"bg-success":"bg-warning"),children:s.is_published?"Published":"Draft"}),e.jsxs("div",{className:"dropdown",children:[e.jsx("button",{className:"btn btn-link text-dark p-0",type:"button","data-bs-toggle":"dropdown",children:e.jsx("i",{className:"bi bi-three-dots-vertical"})}),e.jsxs("ul",{className:"dropdown-menu dropdown-menu-end",children:[e.jsx("li",{children:e.jsxs("button",{className:"dropdown-item",onClick:()=>(e=>{c(`/admin/courses/${e.id}/${e.title.replace(/\s+/g,"-")}`)})(s),children:[e.jsx("i",{className:"bi bi-sliders2 me-2"}),"Manage"]})}),e.jsx("li",{children:e.jsxs("button",{className:"dropdown-item",onClick:()=>h(s),"data-bs-toggle":"modal","data-bs-target":"#course",children:[e.jsx("i",{className:"bi bi-pencil-square me-2"}),"Edit"]})}),e.jsx("li",{children:e.jsx("hr",{className:"dropdown-divider"})}),e.jsx("li",{children:e.jsxs("button",{className:"dropdown-item text-danger",children:[e.jsx("i",{className:"bi bi-trash me-2"}),"Delete"]})})]})]})]}),e.jsx("h5",{className:"card-title mb-1",children:s.title}),e.jsxs("p",{className:"text-muted small mb-2",children:["by ",s.instructor]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("span",{className:"badge bg-info me-2",children:s.category}),e.jsx("span",{className:"badge bg-secondary me-2",children:s.level}),e.jsxs("span",{className:"badge bg-light text-dark",children:[e.jsx("i",{className:"bi bi-clock me-1"}),p(s.duration)]})]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("i",{className:"bi bi-people me-2"}),e.jsx("span",{children:"0 students"})]}),e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("i",{className:"bi bi-star-fill text-warning me-1"}),e.jsx("span",{children:"0 (0 reviews)"})]})]}),e.jsxs("h6",{className:"mb-0 fw-bold",children:["Rp ",parseFloat(s.price).toLocaleString()]})]})]})},s.id)))}),e.jsx(m,{onSubmit:j,detail:b})]})};export{u as default};
//# sourceMappingURL=AdminCourse-CTb1uOP0.js.map
