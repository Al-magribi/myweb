import{d as e,j as s,e as a,f as l,g as i,h as t}from"./index-CZtzjuKv.js";import{b as c,u as d}from"./vendor-CCW8Is9m.js";import{L as n}from"./Layout--3eDNL6g.js";import{R as r}from"./quill.snow-C8zidYNu.js";const o=({refetch:l,editData:i,isEdit:t,setIsEdit:d})=>{const[n,o]=c.useState([""]),[m,h]=c.useState("product"),[x,u]=c.useState({name:"",price:"",description:"",status:"active"}),[b,p]=c.useState(""),[j,N]=c.useState(null),[g,v]=c.useState(null),[f,y]=c.useState(null),[k,{isLoading:w,reset:S}]=e();c.useEffect((()=>{t&&i&&(u({name:i.name||"",price:i.price||"",description:i.description||"",status:i.status||"active"}),h(i.ebook?"ebook":"product"),y(i.image),p(i.description),i.features&&i.features.length>0&&o(i.features))}),[t,i]);const C=e=>{const{name:s,value:a}=e.target;u({...x,[s]:a})},P=()=>{u({name:"",price:"",description:"",status:"active"}),o([""]),N(null),v(null),y(null),h("product"),d();document.querySelector('[data-bs-dismiss="modal"]').click()};return s.jsx("div",{className:"modal fade",id:"addproduct","data-bs-backdrop":"static","data-bs-keyboard":"false",tabIndex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true",children:s.jsx("div",{className:"modal-dialog modal-lg modal-dialog-scrollable",children:s.jsxs("div",{className:"modal-content",children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h1",{className:"modal-title fs-5",id:"staticBackdropLabel",children:t?"Edit Product":"Add Product"}),s.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:P})]}),s.jsx("div",{className:"modal-body",children:s.jsxs("form",{onSubmit:async e=>{e.preventDefault();try{const e=new FormData;e.append("name",x.name),e.append("price",x.price),e.append("description",b),e.append("status",x.status),e.append("type",m);const s=n.filter((e=>""!==e.trim()));e.append("features",JSON.stringify(s)),j&&e.append("image",j),"ebook"===m&&g&&e.append("ebook",g),t&&i&&e.append("id",i.id),await a.promise(k(e).unwrap().then((e=>e.message)),{loading:t?"Updating product...":"Adding product...",success:e=>e,error:e=>e.data.message}),u({name:"",price:"",description:"",status:"active"}),o([""]),N(null),v(null),y(null),h("product"),d(),S();document.querySelector('[data-bs-dismiss="modal"]').click(),l&&l()}catch(s){console.error("Error in form submission:",s)}},children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"form-label",children:"Product Type"}),s.jsxs("div",{className:"d-flex gap-3",children:[s.jsxs("div",{className:"form-check",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"productType",id:"typeProduct",checked:"product"===m,onChange:()=>h("product")}),s.jsx("label",{className:"form-check-label",htmlFor:"typeProduct",children:"Physical Product"})]}),s.jsxs("div",{className:"form-check",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"productType",id:"typeEbook",checked:"ebook"===m,onChange:()=>h("ebook")}),s.jsx("label",{className:"form-check-label",htmlFor:"typeEbook",children:"E-Book"})]})]})]}),s.jsxs("div",{className:"row mb-4",children:[s.jsx("div",{className:"col-md-6",children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{htmlFor:"productName",className:"form-label",children:"Product Name"}),s.jsx("input",{type:"text",className:"form-control",id:"productName",name:"name",value:x.name,onChange:C,placeholder:"Enter product name",required:!0})]})}),s.jsx("div",{className:"col-md-6",children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{htmlFor:"productPrice",className:"form-label",children:"Price"}),s.jsxs("div",{className:"input-group",children:[s.jsx("span",{className:"input-group-text",children:"IDR"}),s.jsx("input",{type:"number",className:"form-control",id:"productPrice",name:"price",value:x.price,onChange:C,placeholder:"0",min:"0",step:"1000",required:!0})]}),s.jsx("small",{className:"text-muted",children:"Enter price in IDR (Indonesian Rupiah)"})]})})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"form-label",children:"Product Image"}),s.jsxs("div",{className:"d-flex align-items-center gap-3",children:[s.jsx("div",{className:"border rounded p-3 text-center",style:{width:"150px",height:"150px"},children:f?s.jsx("img",{src:f,alt:"Preview",style:{width:"100%",height:"100%",objectFit:"cover"}}):s.jsxs(s.Fragment,{children:[s.jsx("i",{className:"bi bi-image text-muted fs-1"}),s.jsx("p",{className:"mb-0 text-muted small",children:"No image"})]})}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("input",{type:"file",className:"form-control",onChange:e=>{const s=e.target.files[0];if(N(s),s){const e=new FileReader;e.onloadend=()=>{y(e.result)},e.readAsDataURL(s)}},accept:"image/*",required:!t}),s.jsx("small",{className:"text-muted",children:"Recommended size: 600x600 pixels"})]})]})]}),"ebook"===m&&s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"form-label",children:"E-Book File"}),t&&(null==i?void 0:i.ebook)&&s.jsx("div",{className:"mb-2",children:s.jsx("a",{href:i.ebook,target:"_blank",rel:"noopener noreferrer",className:"btn btn-link p-0",children:"Lihat/Download E-Book Saat Ini"})}),s.jsx("input",{type:"file",className:"form-control",onChange:e=>{const s=e.target.files[0];v(s)},accept:".pdf,.epub,.mobi",required:"ebook"===m&&!t}),s.jsx("small",{className:"text-muted",children:"Accepted formats: PDF, EPUB, MOBI"})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{htmlFor:"productDescription",className:"form-label",children:"Description"}),s.jsx(r,{theme:"snow",value:b,onChange:p})]}),s.jsxs("div",{className:"mb-4",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsx("label",{className:"form-label mb-0",children:"Key Features"}),s.jsxs("button",{type:"button",className:"btn btn-sm btn-outline-primary",onClick:()=>{o([...n,""])},children:[s.jsx("i",{className:"bi bi-plus-lg me-1"}),"Add Feature"]})]}),n.map(((e,a)=>s.jsxs("div",{className:"input-group mb-2",children:[s.jsx("input",{type:"text",className:"form-control",value:e,onChange:e=>((e,s)=>{const a=[...n];a[e]=s,o(a)})(a,e.target.value),placeholder:`Feature ${a+1}`}),s.jsx("button",{type:"button",className:"btn btn-outline-danger",onClick:()=>(e=>{const s=n.filter(((s,a)=>a!==e));o(s)})(a),children:s.jsx("i",{className:"bi bi-trash"})})]},a)))]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"form-label",children:"Status"}),s.jsxs("div",{className:"form-check",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"status",id:"statusActive",value:"active",checked:"active"===x.status,onChange:C}),s.jsx("label",{className:"form-check-label",htmlFor:"statusActive",children:"Active"})]}),s.jsxs("div",{className:"form-check",children:[s.jsx("input",{className:"form-check-input",type:"radio",name:"status",id:"statusInactive",value:"inactive",checked:"inactive"===x.status,onChange:C}),s.jsx("label",{className:"form-check-label",htmlFor:"statusInactive",children:"Inactive"})]})]}),s.jsxs("div",{className:"modal-footer px-0 pb-0",children:[s.jsx("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",onClick:P,children:"Cancel"}),s.jsx("button",{type:"submit",className:"btn btn-primary",disabled:w,children:w?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),t?"Updating...":"Saving..."]}):t?"Update Product":"Save Product"})]})]})})]})})})},m=({id:e})=>{const[a,i]=c.useState(1),{data:t,isLoading:d,refetch:n}=l({productId:e,page:a,limit:10},{skip:!e}),r=()=>{const e=document.querySelector("[data-bs-dismiss='modal']");e&&e.click()},o=e=>{const a=[],l=Math.floor(e),i=e%1!=0;for(let c=0;c<l;c++)a.push(s.jsx("i",{className:"bi bi-star-fill text-warning"},`full-${c}`));i&&a.push(s.jsx("i",{className:"bi bi-star-half text-warning"},"half"));const t=5-Math.ceil(e);for(let c=0;c<t;c++)a.push(s.jsx("i",{className:"bi bi-star text-warning"},`empty-${c}`));return a},m=t?Math.ceil(t.total/10):0;return s.jsx("div",{className:"modal fade",id:"reviews","data-bs-backdrop":"static",tabIndex:"-1",children:s.jsx("div",{className:"modal-dialog modal-dialog-centered modal-dialog-scrollable",children:s.jsxs("div",{className:"modal-content",children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h1",{className:"modal-title fs-5",children:"Product's Reviews"}),s.jsx("button",{type:"button",className:"btn-close",onClick:r,"aria-label":"Close","data-bs-dismiss":"modal"})]}),s.jsx("div",{className:"modal-body",children:d?s.jsx("div",{className:"text-center py-4",children:s.jsx("div",{className:"spinner-border text-primary",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})})}):t&&t.reviews.length>0?s.jsxs(s.Fragment,{children:[t.reviews.map((e=>s.jsx("div",{className:"card mb-3",children:s.jsxs("div",{className:"card-body",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[s.jsx("div",{children:s.jsx("h6",{className:"mb-0",children:e.name})}),s.jsx("div",{className:"text-warning",children:o(e.rating)})]}),e.comment&&s.jsx("p",{className:"card-text mb-0",children:e.comment})]})},e.id))),s.jsx("nav",{className:"mt-3",children:s.jsxs("ul",{className:"pagination pagination-sm justify-content-center",children:[s.jsx("li",{className:"page-item "+(1===a?"disabled":""),children:s.jsx("button",{className:"page-link",onClick:()=>i(1),disabled:1===a,children:s.jsx("i",{className:"bi bi-chevron-bar-left"})})}),s.jsx("li",{className:"page-item "+(1===a?"disabled":""),children:s.jsx("button",{className:"page-link",onClick:()=>i(a-1),disabled:1===a,children:s.jsx("i",{className:"bi bi-chevron-double-left"})})}),(()=>{let e=Math.max(1,a-2),l=Math.min(m,a+2);l-e<4&&(1===e?l=Math.min(m,e+4):l===m&&(e=Math.max(1,l-4)));const t=[];for(let s=e;s<=l;s++)t.push(s);return t.map((e=>s.jsx("li",{className:"page-item "+(a===e?"active":""),children:s.jsx("button",{className:"page-link",onClick:()=>i(e),children:e})},e)))})(),s.jsx("li",{className:"page-item "+(a===m?"disabled":""),children:s.jsx("button",{className:"page-link",onClick:()=>i(a+1),disabled:a===m,children:s.jsx("i",{className:"bi bi-chevron-double-right"})})}),s.jsx("li",{className:"page-item "+(a===m?"disabled":""),children:s.jsx("button",{className:"page-link",onClick:()=>i(m),disabled:a===m,children:s.jsx("i",{className:"bi bi-chevron-bar-right"})})})]})})]}):s.jsx("div",{className:"text-center py-4",children:s.jsx("p",{className:"text-muted mb-0",children:"No reviews yet"})})}),s.jsx("div",{className:"modal-footer",children:s.jsx("button",{className:"btn btn-sm btn-outline-secondary",onClick:r,"data-bs-dismiss":"modal",children:"Tutup"})})]})})})},h=({products:e,total:l,page:t,limit:n,setEditData:r,setIsEdit:o})=>{const[h,x]=c.useState("");d();const[u,{isLoading:b,isSuccess:p,isError:j,reset:N}]=i();return c.useEffect((()=>{(p||j)&&N()}),[p,j]),console.log(e),s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"card-body",children:[s.jsx("div",{className:"table-responsive",children:s.jsxs("table",{className:"table table-hover align-middle",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Image"}),s.jsx("th",{children:"Name"}),s.jsx("th",{children:"Price"}),s.jsx("th",{children:"Rating"}),s.jsx("th",{children:"Sales"}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Actions"})]})}),s.jsx("tbody",{children:e.map((e=>s.jsxs("tr",{children:[s.jsx("td",{style:{width:"80px"},children:s.jsx("img",{src:e.image,alt:e.name,className:"rounded",style:{width:"60px",height:"60px",objectFit:"cover"}})}),s.jsx("td",{children:s.jsx("div",{children:s.jsx("h6",{className:"mb-0",children:e.name})})}),s.jsxs("td",{children:["Rp ",parseFloat(e.price).toLocaleString("id-ID")]}),s.jsx("td",{children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("i",{className:"bi bi-star-fill text-warning me-1"}),Number(e.rating||0).toFixed(1)]})}),s.jsx("td",{children:parseFloat(e.totalsales).toLocaleString("id-ID")}),s.jsx("td",{children:s.jsx("span",{className:"badge bg-"+("active"===e.status?"success":"secondary"),children:e.status})}),s.jsx("td",{children:s.jsxs("div",{className:"d-flex gap-2",children:[s.jsx("button",{"data-bs-toggle":"modal","data-bs-target":"#addproduct",className:"btn btn-sm btn-outline-warning",onClick:()=>(e=>{r(e),o(!0)})(e),children:s.jsx("i",{className:"bi bi-pencil-square"})}),s.jsx("button",{className:"btn btn-sm btn-outline-info","data-bs-toggle":"modal","data-bs-target":"#reviews",onClick:()=>x(e.id),children:s.jsx("i",{className:"bi bi-chat-dots"})}),s.jsx("button",{className:"btn btn-sm btn-outline-danger",onClick:()=>{return s=e.id,void(window.confirm("Are you sure you want to delete this product?")&&a.promise(u(s).unwrap().then((e=>e.message)),{loading:"Deleting product...",success:e=>e,error:e=>e.data.message}));var s},disabled:b,children:s.jsx("i",{className:"bi bi-trash"})})]})})]},e.id)))})]})}),l>0&&s.jsxs("div",{className:"d-flex justify-content-between align-items-center mt-4",children:[s.jsxs("div",{children:["Showing ",e.length," of ",l," products"]}),s.jsx("nav",{children:s.jsxs("ul",{className:"pagination pagination-sm mb-0",children:[s.jsx("li",{className:"page-item "+(1===t?"disabled":""),children:s.jsx("button",{className:"page-link",onClick:()=>setPage(t-1),disabled:1===t,children:"Previous"})}),s.jsx("li",{className:"page-item",children:s.jsx("span",{className:"page-link",children:t})}),s.jsx("li",{className:"page-item "+(t*n>=l?"disabled":""),children:s.jsx("button",{className:"page-link",onClick:()=>setPage(t+1),disabled:t*n>=l,children:"Next"})})]})})]})]}),s.jsx(m,{id:h})]})},x=()=>{const[e,a]=c.useState(1),[l,i]=c.useState(10),[d,r]=c.useState(""),[m,x]=c.useState(null),[u,b]=c.useState(!1),{data:p,isLoading:j,refetch:N}=t({page:e,limit:l,search:d});if(j)return s.jsx(n,{title:"Admin Products",children:s.jsx("div",{className:"container-fluid",children:s.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"80vh"},children:s.jsx("div",{className:"spinner-border text-primary",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})})})})});const{products:g=[],total:v=0}=p||{},f=v,y=g.reduce(((e,s)=>e+(s.totalsales||0)),0),k=g.length>0?(g.reduce(((e,s)=>e+(s.rating||0)),0)/g.length).toFixed(1):0,w=g.reduce(((e,s)=>e+(s.reviewcount||0)),0);return s.jsxs(n,{title:"Admin Products",children:[s.jsxs("div",{className:"container-fluid",children:[s.jsxs("div",{className:"row mb-4",children:[s.jsx("div",{className:"col-md-6",children:s.jsxs("div",{className:"input-group",children:[s.jsx("input",{type:"text",className:"form-control",placeholder:"Search products...",value:d,onChange:e=>r(e.target.value)}),s.jsx("button",{className:"btn btn-outline-secondary",type:"button",children:s.jsx("i",{className:"bi bi-search"})})]})}),s.jsx("div",{className:"col-md-6 text-end",children:s.jsxs("button",{type:"button","data-bs-toggle":"modal","data-bs-target":"#addproduct",className:"btn btn-primary",children:[s.jsx("i",{className:"bi bi-plus-lg me-2"}),"Add Product"]})})]}),s.jsxs("div",{className:"row g-4 mb-4",children:[s.jsx("div",{className:"col-12 col-sm-6 col-xl-3",children:s.jsx("div",{className:"card h-100",children:s.jsx("div",{className:"card-body",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("div",{className:"flex-shrink-0 me-3",children:s.jsx("div",{className:"p-3 rounded bg-primary bg-opacity-10",children:s.jsx("i",{className:"bi bi-box text-primary fs-4"})})}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Total Products"}),s.jsx("h4",{className:"mb-0",children:f.toLocaleString()})]})]})})})}),s.jsx("div",{className:"col-12 col-sm-6 col-xl-3",children:s.jsx("div",{className:"card h-100",children:s.jsx("div",{className:"card-body",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("div",{className:"flex-shrink-0 me-3",children:s.jsx("div",{className:"p-3 rounded bg-success bg-opacity-10",children:s.jsx("i",{className:"bi bi-graph-up text-success fs-4"})})}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Total Sales"}),s.jsx("h4",{className:"mb-0",children:parseFloat(y).toLocaleString("id-ID")})]})]})})})}),s.jsx("div",{className:"col-12 col-sm-6 col-xl-3",children:s.jsx("div",{className:"card h-100",children:s.jsx("div",{className:"card-body",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("div",{className:"flex-shrink-0 me-3",children:s.jsx("div",{className:"p-3 rounded bg-warning bg-opacity-10",children:s.jsx("i",{className:"bi bi-star text-warning fs-4"})})}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Average Rating"}),s.jsx("h4",{className:"mb-0",children:k})]})]})})})}),s.jsx("div",{className:"col-12 col-sm-6 col-xl-3",children:s.jsx("div",{className:"card h-100",children:s.jsx("div",{className:"card-body",children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("div",{className:"flex-shrink-0 me-3",children:s.jsx("div",{className:"p-3 rounded bg-info bg-opacity-10",children:s.jsx("i",{className:"bi bi-chat-dots text-info fs-4"})})}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsx("h6",{className:"text-muted mb-1",children:"Total Reviews"}),s.jsx("h4",{className:"mb-0",children:parseFloat(w).toLocaleString("id-ID")})]})]})})})})]}),s.jsx(h,{products:g,total:v,page:e,limit:l,setEditData:x,setIsEdit:b})]}),s.jsx(o,{refetch:N,editData:m,setEditData:()=>x(null),isEdit:u,setIsEdit:()=>b(!1),onClose:()=>{x(null),b(!1)}})]})};export{x as default};
//# sourceMappingURL=AdminProducts-Jt4WYOSo.js.map
